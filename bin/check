#!/usr/bin/env ruby
# frozen_string_literal: true

# flush output immediately
$stdout.sync = true

require File.expand_path("../../lib/check.rb", __FILE__)

errors = ARGV.map do |file|
  case File.extname(file)
  when ".xml"
    Check::Date.mods(file)
  when ".csv"
    Check::Date.csv(file)
  else
    raise ArgumentError, "Unsupported file type: #{file}"
  end
end.flatten

exit 0 if errors.empty?

errors.each do |err|
  $stderr.puts err.message
end

exit 1
