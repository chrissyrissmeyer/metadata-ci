#!/usr/bin/env ruby
# frozen_string_literal: true

# flush output immediately
$stdout.sync = true

require File.expand_path("../../lib/date_checker.rb", __FILE__)

errors = ARGV.map do |file|
  case File.extname(file)
  when ".xml"
    DateChecker.mods(file)
  when ".csv"
    DateChecker.csv(file)
  else
    raise ArgumentError, "Unsupported file type: #{file}"
  end
end.flatten

exit 0 if errors.empty?

errors.each do |err|
  $stderr.puts err.message
end

exit 1
